A = [1, 2, 3, 4, 5]
N = 5


def input_relation():
    print("5x5 관계 행렬을 입력하세요.(공백으로 구분)")
    R = []
    for i in range(N):
        row = list(map(int, input(f"행 {i+1}: ").split()))
        R.append(row)
    return R


def is_reflexive(R):
    for i in range(N):
        if R[i][i] != 1:
            return False
    return True


def is_symmetry(R):
    for i in range(N):
        for j in range(N):
            if R[i][j] != R[j][i]:
                return False
    return True


def is_transitive(R):
    for i in range(N):
        for j in range(N):
            if R[i][j] == 1:
                for k in range(N):
                    if R[j][k] == 1 and R[i][k] == 0:
                        return False
    return True



def equivalence_class(R, x_index):
    eq = []
    for j in range(N):
        if R[x_index][j] == 1:
            eq.append(A[j])
    return eq


def reflexive_closure(R):
    Rc = [row[:] for row in R]
    for i in range(N):
        Rc[i][i] = 1
    return Rc


def symmetry_closure(R):
    Sc = [row[:] for row in R]
    for i in range(N):
        for j in range(N):
            if R[i][j] == 1:
                Sc[j][i] = 1
    return Sc


def transitive_closure(R):
    Tc = [row[:] for row in R]
    for k in range(N):
        for i in range(N):
            for j in range(N):
                Tc[i][j] = Tc[i][j] or (Tc[i][k] and Tc[k][j])
    return Tc


def print_matrix(M):
    for row in M:
        print(row)
    print()


def main():
    R = input_relation()

    print("\n관계 행렬:")
    print_matrix(R)

    ref = is_reflexive(R)
    sym = is_symmetry(R)
    tra = is_transitive(R)

    print("반사성:", ref)
    print("대칭성:", sym)
    print("추이성:", tra)

    if ref and sym and tra:
        print("\n➡ 동치 관계입니다.\n")
        for i in range(N):
            print(f"{A[i]}의 동치류 =", equivalence_class(R, i))
    else:
        print("\n➡ 동치 관계가 아닙니다.")

        print("반사 폐포 전:")
        print_matrix(R)
        Rr = reflexive_closure(R)
        print("반사 폐포 후:")
        print_matrix(Rr)

        print("대칭 폐포 전:")
        print_matrix(R)
        Rs = symmetry_closure(R)
        print("대칭 폐포 후:")
        print_matrix(Rs)

        print("추이 폐포 전:")
        print_matrix(R)
        Rt = transitive_closure(R)
        print("추이 폐포 후:")
        print_matrix(Rt)

        print("\n모든 폐포 적용하여 만든 동치 관계:")
        R_total = transitive_closure(symmetry_closure(reflexive_closure(R)))
        print_matrix(R_total)

        if is_reflexive(R_total) and is_symmetry(R_total) and is_transitive(R_total):
            print("동치 관계가 되었습니다.\n")

            for i in range(N):
                print(f"{A[i]}의 동치류 =", equivalence_class(R_total, i))
        else:
            print("동치 관계가 되지 않았습니다.")

main()
